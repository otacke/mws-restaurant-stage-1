var $jscomp$this=this,restaurant,map;window.initMap=function(){fetchRestaurantFromURL(function(b,e){b?console.error(b):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};
fetchRestaurantFromURL=function(b){if(self.restaurant)b(null,self.restaurant);else{var e=getParameterByName("id");e?(DBHelper.fetchRestaurantById(e,function(a,c){(self.restaurant=c)?(fillRestaurantHTML(),b(null,c)):console.error(a)}),DBHelper.fetchReviewsByRestaurant(e,function(a,b){(self.reviews=b)||console.error(a);fillOwnReviewHTML(parseInt(e));fillReviewsHTML()})):b("No restaurant id in URL",null)}};
fillRestaurantHTML=function(b){b=void 0===b?self.restaurant:b;document.getElementById("restaurant-name").innerHTML=b.name;document.getElementById("restaurant-address").innerHTML=b.address;var e=DBHelper.imageUrlForRestaurant(b),a=e.replace(".webp","_280w.webp"),c=e.replace(".webp","_480w.webp"),d=document.getElementById("restaurant-img");d.className="restaurant-img";d.src=e;d.srcset=a+" 280w, "+c+" 480w, "+e+" 800w";d.sizes="(max-width: 450px) 280px, (max-width: 600px) 480px, 800px";d.alt="An image of restaurant"+
b.name+" in "+b.neighborhood;document.getElementById("restaurant-cuisine").innerHTML=b.cuisine_type;b.operating_hours&&fillRestaurantHoursHTML()};
fillRestaurantHoursHTML=function(b){b=void 0===b?self.restaurant.operating_hours:b;var e=document.getElementById("restaurant-hours"),a;for(a in b){var c=document.createElement("div");c.setAttribute("role","listitem");c.setAttribute("tabindex",0);c.classList.add("restaurant-hours-row");var d=document.createElement("div");d.classList.add("restaurant-hours-day");d.innerHTML=a;c.appendChild(d);d=document.createElement("div");d.classList.add("restaurant-hours-time");d.innerHTML=b[a];c.appendChild(d);e.appendChild(c)}};
fillOwnReviewHTML=function(b){var e=document.getElementById("review-own"),a=document.createElement("h3");a.innerHTML="Your Review";a.id="own-review-title";e.appendChild(a);$jscomp$this.form=document.createElement("form");$jscomp$this.form.setAttribute("action",DBHelper.DATABASE_URL_REVIEWS);$jscomp$this.form.setAttribute("method","POST");$jscomp$this.form.classList.add("reviews-form");a=document.createElement("input");a.setAttribute("id","restaurant-id");a.setAttribute("name","restaurant_id");a.setAttribute("type",
"hidden");a.setAttribute("value",b);$jscomp$this.form.appendChild(a);b=(new Date).getTime();a=document.createElement("input");a.setAttribute("id","created-at");a.setAttribute("name","createdAt");a.setAttribute("type","hidden");a.setAttribute("value",b);$jscomp$this.form.appendChild(a);a=document.createElement("input");a.setAttribute("id","updated-at");a.setAttribute("name","updatedAt");a.setAttribute("type","hidden");a.setAttribute("value",b);$jscomp$this.form.appendChild(a);b=document.createElement("div");
b.classList.add("review-form-field");a=document.createElement("label");a.classList.add("review-form-label");a.setAttribute("for","name");a.innerHTML="Name";b.appendChild(a);a=document.createElement("input");a.classList.add("review-form-item");a.setAttribute("id","name");a.setAttribute("name","name");a.setAttribute("placeholder","Your name");a.setAttribute("type","text");a.setAttribute("required","required");b.appendChild(a);a=document.createElement("div");a.classList.add("review-form-field");var c=
document.createElement("label");c.classList.add("review-form-label");c.setAttribute("for","rating");c.innerHTML="Rating";a.appendChild(c);c=document.createElement("select");c.classList.add("review-form-item");c.setAttribute("id","rating");c.setAttribute("name","rating");for(var d=1;5>=d;d++){var f=document.createElement("option");f.setAttribute("value",d);f.innerHTML=d;3===d&&f.setAttribute("selected","selected");c.appendChild(f)}c.setAttribute("type","number");c.setAttribute("required","required");
a.appendChild(c);c=document.createElement("div");c.classList.add("review-form-field");d=document.createElement("label");d.classList.add("review-form-label");d.setAttribute("for","comments");d.innerHTML="Comments";c.appendChild(d);d=document.createElement("textarea");d.classList.add("review-form-item");d.setAttribute("id","comments");d.setAttribute("name","comments");d.setAttribute("placeholder","Please write your review here ...");d.setAttribute("rows",4);d.setAttribute("required","required");c.appendChild(d);
d=document.createElement("input");d.setAttribute("type","submit");d.innerHTML="Submit Review";$jscomp$this.form.appendChild(b);$jscomp$this.form.appendChild(a);$jscomp$this.form.appendChild(c);$jscomp$this.form.appendChild(d);e.appendChild($jscomp$this.form);$jscomp$this.form.addEventListener("submit",function(a){a.preventDefault();a={restaurant_id:parseInt($jscomp$this.form.querySelector("#restaurant-id").value),name:strip($jscomp$this.form.querySelector("#name").value),createdAt:parseInt($jscomp$this.form.querySelector("#created-at").value),
updatedAt:parseInt($jscomp$this.form.querySelector("#updated-at").value),rating:parseInt($jscomp$this.form.querySelector("#rating").value),comments:strip($jscomp$this.form.querySelector("#comments").value)};DBHelper.postReview(a).then(function(a){$jscomp$this.reviews.push(a);fillReviewsHTML()})["catch"](function(a){console.error("Could not post review",a)});$jscomp$this.form.reset()});$jscomp$this.favButton=document.createElement("button");$jscomp$this.favButton.classList.add("fav-toggle");updateFavButton(self.restaurant.is_favorite);
$jscomp$this.favButton.addEventListener("click",function(){self.restaurant.is_favorite=!self.restaurant.is_favorite;DBHelper.toggleFav(self.restaurant);updateFavButton(self.restaurant.is_favorite)});e.appendChild(favButton)};updateFavButton=function(b){!0===b?($jscomp$this.favButton.classList.add("fav-true"),$jscomp$this.favButton.innerHTML="You LIKE this restaurant!"):($jscomp$this.favButton.classList.remove("fav-true"),$jscomp$this.favButton.innerHTML="You do NOT like this restaurant.")};
strip=function(b){return(new DOMParser).parseFromString(b,"text/html").body.textContent||""};fillReviewsHTML=function(b){b=void 0===b?this.reviews:b;var e=document.getElementById("reviews-container"),a=document.getElementById("reviews-list");a.innerHTML="";var c=document.createElement("h3");c.innerHTML="Other Reviews";c.id="review-title";a.appendChild(c);b?(b.forEach(function(b){a.appendChild(createReviewHTML(b))}),e.appendChild(a)):(b=document.createElement("p"),b.innerHTML="No reviews yet!",e.appendChild(b))};
createReviewHTML=function(b){var e=document.createElement("div");e.setAttribute("role","listitem");e.setAttribute("tabindex",0);e.classList.add("reviews-item");var a=document.createElement("div");a.classList.add("review-header");e.appendChild(a);var c=document.createElement("p");c.classList.add("review-name");c.innerHTML=b.name;a.appendChild(c);c=document.createElement("p");c.classList.add("review-date");c.innerHTML=(new Date(b.updatedAt||b.createdAt||void 0)).toLocaleDateString();a.appendChild(c);
c=document.createElement("p");c.classList.add("review-rating");c.innerHTML="Rating: "+b.rating;a.appendChild(c);a=document.createElement("p");a.classList.add("review-comments");a.innerHTML=b.comments;e.appendChild(a);return e};fillBreadcrumb=function(b){b=void 0===b?self.restaurant:b;var e=document.getElementById("breadcrumb"),a=document.createElement("li");a.innerHTML=b.name;e.appendChild(a)};
getParameterByName=function(b,e){e||(e=window.location.href);b=b.replace(/[\[\]]/g,"\\$&");var a=(new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)")).exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};navigator.serviceWorker&&navigator.serviceWorker.register("/sw.min.js").then(function(){return console.log("Service worker has been registered.")})["catch"](function(b){return console.log("Could not register service worker ("+b+").")});
